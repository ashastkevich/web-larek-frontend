https://github.com/ashastkevich/web-larek-frontend.git

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Архитектура

Проект реализует архитектуру MVP (Model-View-Presenter).  
**Слой модели данных** отвечает за хранение и обработку данных, **слой представление** отвечает за отображение и взаимодействие с пользователем.  
**Презентер** реализован в основном файле src/index.ts виде событийной системы и логики связывания моделей и представлений через EventEmitter.

---

## Слой представления

---

### Класс **Component**

Базовый абстрактный класс для всех компонентов пользовательского интерфейса. Предоставляет базовые методы для работы с DOM-элементами, установки текста, изображений, блокировки элементов и рендера.
Служит основой для всех UI-компонентов проекта. Он инкапсулирует общую логику работы с DOM и предоставляет удобные методы для наследования и расширения в специализированных компонентах (карточки, формы, модальные окна и т.д.).

---

**Конструктор:**

```typescript
constructor(protected readonly container: HTMLElement)
```
- **container** (`HTMLElement`) — DOM-элемент, который будет являться корневым элементом компонента. 

---

**Поля класса:**

- **container** (`HTMLElement`)  
  Корневой DOM-элемент компонента. В этом элементе происходит поиск вложенных элементов, установка текста, изображений и т.д.

---

**Методы:**

- **setText(element: HTMLElement, value: string | number): void**  
  Устанавливает текстовое содержимое переданного элемента.  
  - `element` — элемент, в который будет установлен текст  
  - `value` — строка или число, которое будет установлено как текст

- **setImage(element: HTMLImageElement, src: string): void**  
  Устанавливает путь к изображению для переданного элемента `<img>`.  
  - `element` — элемент изображения  
  - `src` — строка с URL изображения

- **setHidden(element: HTMLElement): void**  
  Скрывает элемент, устанавливая стиль `display: none`.  
  - `element` — элемент, который нужно скрыть.

- **setVisible(element: HTMLElement): void**  
  Делает элемент видимым, сбрасывая стиль `display`.  
  - `element` — элемент, который нужно показать.

- **toggleClass(element: HTMLElement, className: string, state: boolean): void**  
  Добавляет или убирает CSS-класс у элемента в зависимости от значения `state`.  
  - `element` — элемент, у которого меняется класс  
  - `className` — имя CSS-класса  
  - `state` — если `true`, класс добавляется, если `false` — убирается

- **setDisabled(element: HTMLElement, state: boolean): void**  
  Блокирует или разблокирует элемент (например, кнопку) с помощью атрибута `disabled`.  
  - `element` — элемент, который нужно заблокировать/разблокировать  
  - `state` — если `true`, элемент блокируется, если `false` — разблокируется

- **render(data: object): HTMLElement**  
  Базовый метод для рендера компонента. 
  - `data` — объект с данными для рендера  
  - Возвращает корневой DOM-элемент компонента (`HTMLElement`)

---

### Класс **Modal**

Класс **Modal** отвечает за управление модальными окнами в приложении: открытие, закрытие, установка и получение содержимого, а также обработку пользовательских событий.

---

**Конструктор:**

```typescript
constructor(container: HTMLElement, events: IEvents)
```
- **container** (`HTMLElement`) — DOM-элемент, который является корневым элементом модального окна. Содержит структуру модального окна и его содержимое.
- **events** (`IEvents`) — экземпляр системы событий для взаимодействия с другими частями приложения.

---

**Поля класса:**

- **container** (`HTMLElement`)  
  Корневой DOM-элемент модального окна. В нем происходит отображение и скрытие модального окна, а также поиск вложенных элементов.

- **events** (`IEvents`)  
  Экземпляр событийной системы, используемый для подписки и генерации событий, связанных с модальным окном.

- **_content** (`HTMLElement`)  
  Текущий DOM-элемент, который отображается внутри модального окна.

---

**Геттеры и сеттеры:**

- **get content(): HTMLElement**  
  Возвращает текущий DOM-элемент содержимого модального окна.

- **set content(value: HTMLElement)**  
  Устанавливает новый DOM-элемент в качестве содержимого модального окна. Происходит замена содержимого внутри контейнера модального окна на переданный элемент.

---

**Методы:**

- **open(): void**  
  Открывает модальное окно.

- **close(): void**  
  Закрывает модальное окно.

- **render(data: IModalData): HTMLElement**
  Рендерит компонент и открывает модальное окно. 
  - `data` — объект с данными для рендера  
  - Возвращает корневой DOM-элемент компонента (`HTMLElement`)

---

### Класс **Form**

Класс **Form** — базовый класс для работы с формами в приложении. Обеспечивает сбор, валидацию и установку значений полей формы, а также управление состоянием и обработку событий.

---

**Конструктор:**

```typescript
constructor(container: HTMLElement, events: IEvents)
```
- **container** (`HTMLElement`) — DOM-элемент формы, в котором находятся все поля и кнопки управления.
- **events** (`IEvents`) — экземпляр системы событий для взаимодействия с другими частями приложения.

---

**Свойства класса:**

- **container** (`HTMLElement`)  
  Корневой DOM-элемент формы.

- **events** (`IEvents`)  
  Экземпляр событийной системы для генерации и обработки событий, связанных с формой.

- **fields** (`Record<string, HTMLInputElement>`)  
  Объект, где ключ — имя поля, а значение — соответствующий элемент `<input>` или `<textarea>`. Используется для быстрого доступа к полям формы.

- **_valid** (`boolean`)  
  Приватное свойство, отражающее валидность формы.

- **_errors** (`string[]`)  
  Приватное свойство, массив строк с ошибками валидации.

---

**Геттеры и сеттеры:**

- **get valid(): boolean**  
  Возвращает текущее состояние валидности формы.

- **set valid(value: boolean)**  
  Устанавливает состояние валидности формы. Может использоваться для визуального отображения ошибок или блокировки кнопки отправки.

- **get errors(): string[]**  
  Возвращает массив ошибок валидации.

- **set errors(value: string[])**  
  Устанавливает массив ошибок валидации. Может использоваться для отображения ошибок пользователю.

---

**Методы:**

- **onInputChange(field: keyof T, value: string): void**
  Метод вызывается при каждом изменении любого поля формы (событие input). Он генерирует событие через систему событий (this.events.emit), передавая имя поля и новое значение. 
  - field (keyof T) — имя поля формы, в котором произошло изменение.
  - value (string) — новое значение этого поля.

- **getValues(): Record<string, string>**  
  Собирает значения всех полей формы и возвращает объект, где ключ — имя поля, значение — текущее значение поля.  

- **setValues(values: Record<string, string>): void**  
  Устанавливает значения полей формы из переданного объекта.  
  - `values` — объект, где ключ — имя поля, значение — новое значение для этого поля.  

- **validate(): boolean**  
  Проверяет валидность всех полей формы. Может реализовывать как простую проверку на заполненность, так и сложную логику (например, email, телефон).  
  Возвращает `true`, если форма валидна, иначе `false`.  

- **reset(): void**  
  Сбрасывает значения всех полей формы к значениям по умолчанию.  

- **setFieldError(fieldName: string, error: string): void**  
  Устанавливает ошибку для конкретного поля.  
  - `fieldName` — имя поля  
  - `error` — текст ошибки  

- **clearErrors(): void**  
  Очищает все ошибки формы и сбрасывает визуальное отображение ошибок.

- **setDisabled(state: boolean): void**  
  Блокирует или разблокирует все поля и кнопки формы.  
  - `state` — если `true`, форма блокируется, если `false` — разблокируется.

---

### Класс **Page**

Класс **Page** управляет главной страницей приложения: отображением каталога товаров, счетчиком корзины, блокировкой прокрутки и обработкой открытия корзины.

---

**Конструктор:**

```typescript
constructor(container: HTMLElement, events: IEvents)
```
- **container** (`HTMLElement`) — корневой DOM-элемент страницы, в который рендерится всё содержимое приложения.
- **events** (`IEvents`) — экземпляр системы событий для взаимодействия с другими частями приложения.

---

**Свойства класса:**

- **catalog** (`HTMLElement`)  
  DOM-элемент, содержащий галерею товаров (каталог). Используется для рендера карточек товаров.

- **cartCountElement** (`HTMLElement`)  
  DOM-элемент, отображающий количество товаров в корзине.

- **wrapper** (`HTMLElement`)  
  DOM-элемент-обертка всей страницы. Используется для блокировки прокрутки при открытии модальных окон.

- **cartButtonElement** (`HTMLButtonElement`)  
  Кнопка открытия корзины. При нажатии вызывает событие открытия корзины.

- **events** (`IEvents`)  
  Экземпляр событийной системы для генерации и обработки событий.

---

**Сеттеры:**

- **set catalogContainer(value: HTMLElement[])**  
  Заменяет содержимое каталога товаров на переданный массив элементов.  
  - `value` — массив DOM-элементов карточек товаров, которые будут отображаться в каталоге.

- **set cartCount(value: number)**  
  Устанавливает новое значение счетчика товаров в корзине.  
  - `value` — число, отображаемое в счетчике корзины.

- **set locked(value: boolean)**  
  Управляет блокировкой прокрутки страницы.  
  - Если `value` равен `true`, добавляет класс `'page__wrapper_locked'` к обертке страницы, блокируя прокрутку.
  - Если `value` равен `false`, убирает этот класс, разблокируя прокрутку.

---

### Класс **CardCatalog**

**Общая информация**
Класс `CardCatalog` наследуется от абстрактного класса `Component<IProduct>` и представляет собой компонент карточки товара в каталоге. Он отвечает за отображение информации о товаре и обработку пользовательских взаимодействий.
При клике на карточку генерируется событие `product:click` с объектом, содержащим идентификатор товара. Объект приводится к типу `IProduct`.

**Конструктор класса**

```typescript
constructor(container: HTMLElement, protected events: IEvents)
```

**Параметры:**
1. **`container: HTMLElement`** - корневой DOM-элемент, в котором будет размещаться компонент карточки товара. Это должен быть HTML-элемент, содержащий все необходимые дочерние элементы карточки.
   
2. **`events: IEvents`** (protected) - экземпляр системы событий, реализующий интерфейс `IEvents`. Используется для генерации событий при взаимодействии пользователя с карточкой товара.

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Component` с переданным контейнером.
2. Инициализирует DOM-элементы карточки:
   - Находит и сохраняет ссылки на все необходимые элементы внутри контейнера
   - Приводит типы элементов там, где это необходимо (например, для изображения)
3. Настраивает обработчик клика на кнопке карточки, который генерирует событие `product:click` с идентификатором товара.

**Свойства класса**

1. **`protected cardCategory: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий категорию товара.

2. **`protected cardTitle: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий название товара.

3. **`protected cardPrice: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий цену товара.

4. **`protected cardImage: HTMLImageElement`**  
   - *Тип:* `HTMLImageElement`  
   - *Описание:* Ссылка на элемент изображения товара (`<img>`).

5. **`protected cardButton: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Ссылка на кнопку карточки товара. В данном случае используется весь контейнер карточки как кнопка.

6. **`protected productId: string`**  
   - *Тип:* `string`  
   - *Описание:* Хранит идентификатор товара, который передается при генерации события клика.

7. **`protected events: IEvents`**  
   - *Тип:* `IEvents`  
   - *Описание:* Экземпляр системы событий, унаследованный от параметра конструктора. Используется для генерации событий.

**Сеттеры**

1. **`set id(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Устанавливает идентификатор товара (`productId`), который будет использоваться при генерации события клика.

2. **`set category(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет текст в элементе категории товара (`cardCategory`), используя унаследованный метод `setText`.

3. **`set title(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет текст в элементе названия товара (`cardTitle`), используя унаследованный метод `setText`.

4. **`set price(value: number)`**  
   - *Тип параметра:* `number`  
   - *Описание:* Обновляет текст в элементе цены товара (`cardPrice`), используя унаследованный метод `setText`. Числовое значение автоматически преобразуется в строку.

5. **`set image(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет источник изображения товара (`cardImage`), используя унаследованный метод `setImage`.


### Класс `CardPreview`

**Общая информация**
Класс `CardPreview` наследуется от абстрактного класса `Component<IProduct>` и представляет собой компонент карточки предпросмотра товара. Он отвечает за отображение детальной информации о товаре и обработку пользовательских взаимодействий, включая добавление/удаление товара из корзины.

**Конструктор класса**

```typescript
constructor(container: HTMLElement, protected events: IEvents)
```
**Параметры:**
1. **`container: HTMLElement`** - корневой DOM-элемент, в котором будет размещаться компонент карточки предпросмотра товара. Это должен быть HTML-элемент, содержащий все необходимые дочерние элементы карточки.
   
2. **`events: IEvents`** (protected) - экземпляр системы событий, реализующий интерфейс `IEvents`. Используется для генерации событий при взаимодействии пользователя с карточкой товара.

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Component` с переданным контейнером.
2. Инициализирует DOM-элементы карточки:
   - Находит и сохраняет ссылки на все необходимые элементы внутри контейнера
   - Приводит типы элементов там, где это необходимо (например, для изображения и кнопок)
3. Настраивает обработчик клика на кнопке добавления в корзину, который генерирует событие `cart:add` с текущим экземпляром карточки.

**Свойства класса**

1. **`protected cardCategory: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий категорию товара.

2. **`protected cardTitle: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий название товара.

3. **`protected cardDescription: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий описание товара.

4. **`protected cardPrice: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий цену товара.

5. **`protected cardImage: HTMLImageElement`**  
   - *Тип:* `HTMLImageElement`  
   - *Описание:* Ссылка на элемент изображения товара (`<img>`).

6. **`protected cardButtonCart: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Ссылка на кнопку добавления/удаления товара из корзины.

7. **`protected productId: string`**  
   - *Тип:* `string`  
   - *Описание:* Хранит идентификатор товара, который может использоваться для идентификации товара в системе.

8. **`protected isIncluded: boolean`**  
   - *Тип:* `boolean`  
   - *Значение по умолчанию:* `false`  
   - *Описание:* Флаг, указывающий на наличие товара в корзине. Используется для управления состоянием кнопки корзины.

9. **`protected events: IEvents`**  
    - *Тип:* `IEvents`  
    - *Описание:* Экземпляр системы событий, унаследованный от параметра конструктора. Используется для генерации событий.

**Методы класса**

1. **`updateButton(isInCart: boolean): void`**  
   - *Параметры:*
     - `isInCart: boolean` - флаг, указывающий находится ли товар в корзине
   - *Описание:* Обновляет текст кнопки корзины в зависимости от состояния (`В корзину` или `Удалить из корзины`) и сохраняет текущее состояние в свойстве `isIncluded`.

2. **`render(data: IProduct): HTMLElement`**  
   - *Параметры:*
     - `data: IProduct` - объект с данными о товаре
   - *Возвращает:* `HTMLElement` - контейнер компонента
   - *Описание:* Основной метод рендеринга компонента, вызывает соответствующие сеттеры для обновления всех полей карточки.

**Сеттеры**

1. **`set id(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Устанавливает идентификатор товара (`productId`).

2. **`set category(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет текст в элементе категории товара (`cardCategory`), используя унаследованный метод `setText`.

3. **`set title(value: string)`**  
   - *Тип парамета:* `string`  
   - *Описание:* Обновляет текст в элементе названия товара (`cardTitle`), используя унаследованный метод `setText`.

4. **`set description(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет текст в элементе описания товара (`cardDescription`), используя унаследованный метод `setText`.

5. **`set price(value: number)`**  
   - *Тип параметра:* `number`  
   - *Описание:* Обновляет текст в элементе цены товара (`cardPrice`), используя унаследованный метод `setText`. Числовое значение автоматически преобразуется в строку.

6. **`set image(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет источник изображения товара (`cardImage`), используя унаследованный метод `setImage`.

7. **`set isInCart(value: boolean)`**  
   - *Тип параметра:* `boolean`  
   - *Описание:* Устанавливает флаг наличия товара в корзине (`isIncluded`).

**Геттеры**

1. **`get id(): string`**  
   - *Возвращает:* `string`  
   - *Описание:* Возвращает идентификатор товара (`productId`). Позволяет получить текущий ID товара.


### Класс `Basket`

**Общая информация**
Класс `Basket` наследуется от абстрактного класса `Component<IBasket>` и представляет собой компонент корзины покупок. Он отвечает за отображение списка товаров в корзине, общей суммы заказа и обработку действий пользователя по оформлению заказа.

**Конструктор класса**

```typescript
constructor(container: HTMLElement, protected events: IEvents)
```

**Параметры:**
1. **`container: HTMLElement`** - корневой DOM-элемент, содержащий всю структуру корзины. Должен включать элементы с классами `.basket__list`, `.basket__button` и `.basket__price`.

2. **`events: IEvents`** (protected) - экземпляр системы событий, реализующий интерфейс `IEvents`. Используется для генерации событий при взаимодействии пользователя с корзиной.

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Component` с переданным контейнером.
2. Инициализирует DOM-элементы корзины:
   - Находит элемент списка товаров (`.basket__list`)
   - Находит кнопку оформления заказа (`.basket__button`) и приводит тип к `HTMLButtonElement`
   - Находит элемент для отображения общей суммы (`.basket__price`)
3. Настраивает обработчик клика на кнопке оформления заказа, который генерирует событие `order:open`.

**Свойства класса**

1. **`protected basketList: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, содержащий список товаров в корзине.

2. **`protected orderButton: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Ссылка на кнопку оформления заказа.

3. **`protected totalPrice: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий общую стоимость товаров в корзине.

4. **`protected events: IEvents`**  
   - *Тип:* `IEvents`  
   - *Описание:* Экземпляр системы событий, унаследованный от параметра конструктора. Используется для генерации событий при взаимодействии с корзиной.

**сеттеры**

1. **`set items(value: HTMLElement[] | string)`**  
   - *Тип параметра:* `HTMLElement[] | string`  
   - *Описание:* Обновляет содержимое списка товаров в корзине. Принимает либо массив DOM-элементов (которые будут добавлены в список), либо строку (которая будет преобразована в текстовый узел). Использует метод `replaceChildren` для полной замены содержимого списка.

2. **`set total(value: number)`**  
   - *Тип параметра:* `number`  
   - *Описание:* Обновляет отображение общей суммы заказа. Числовое значение форматируется в строку с добавлением "синапсов" (например: "1000 синапсов") и устанавливается как текст элемента `totalPrice`.

3. **`set button(state: boolean)`**  
   - *Тип параметра:* `boolean`  
   - *Описание:* Управляет состоянием кнопки оформления заказа. При `true` кнопка становится неактивной (disabled), при `false` - активной. Используется для блокировки оформления заказа при пустой корзине.


### Класс `CardBasket`

**Общая информация**
Класс `CardBasket` наследуется от абстрактного класса `Component<IProduct>` и представляет собой компонент карточки товара в корзине покупок. Он отвечает за отображение информации о товаре в корзине и обработку действий пользователя по удалению товара из корзины.

**Конструктор класса**

```typescript
constructor(container: HTMLElement, protected events: IEvents)
```

**Параметры:**
1. **`container: HTMLElement`** - корневой DOM-элемент, содержащий всю структуру карточки товара в корзине. Должен включать элементы с классами:
   - `.basket__item-index` - для отображения порядкового номера
   - `.card__title` - для отображения названия товара
   - `.card__price` - для отображения цены товара
   - `.basket__item-delete` - кнопка удаления товара

2. **`events: IEvents`** (protected) - экземпляр системы событий, реализующий интерфейс `IEvents`. Используется для генерации событий при взаимодействии пользователя с карточкой товара.

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Component` с переданным контейнером.
2. Инициализирует DOM-элементы карточки товара в корзине:
   - Находит элемент для отображения порядкового номера товара
   - Находит элемент для отображения названия товара
   - Находит элемент для отображения цены товара
   - Находит кнопку удаления товара и приводит тип к `HTMLButtonElement`
3. Настраивает обработчик клика на кнопке удаления товара, который генерирует событие `cartItem:remove` с текущим экземпляром карточки.

**Свойства класса**

1. **`protected basketItemIndex: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий порядковый номер товара в корзине.

2. **`protected cardTitle: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий название товара.

3. **`protected cardPrice: HTMLElement`**  
   - *Тип:* `HTMLElement`  
   - *Описание:* Ссылка на DOM-элемент, отображающий цену товара.

4. **`protected deleteButton: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Ссылка на кнопку удаления товара из корзины.

5. **`protected productId: string`**  
   - *Тип:* `string`  
   - *Описание:* Хранит идентификатор товара, который используется для идентификации товара при удалении из корзины.

6. **`protected events: IEvents`**  
   - *Тип:* `IEvents`  
   - *Описание:* Экземпляр системы событий, унаследованный от параметра конструктора. Используется для генерации событий при взаимодействии с карточкой товара.

**Сеттеры**

1. **`set id(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Устанавливает идентификатор товара (`productId`), который используется при удалении товара из корзины.

2. **`set index(value: number)`**  
   - *Тип параметра:* `number`  
   - *Описание:* Обновляет отображение порядкового номера товара в корзине. Числовое значение преобразуется в строку и устанавливается как текст элемента `basketItemIndex`.

3. **`set title(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Обновляет текст в элементе названия товара (`cardTitle`), используя унаследованный метод `setText`.

4. **`set price(value: number)`**  
   - *Тип параметра:* `number`  
   - *Описание:* Обновляет текст в элементе цены товара (`cardPrice`), используя унаследованный метод `setText`. Числовое значение автоматически преобразуется в строку.

**Геттеры**

1. **`get id(): string`**  
   - *Возвращает:* `string`  
   - *Описание:* Возвращает идентификатор товара (`productId`). Позволяет получить текущий ID товара без прямого доступа к защищенному свойству. Используется при удалении товара из корзины для идентификации удаляемого элемента.


### Класс `Order`

**Общая информация**
Класс `Order` наследуется от класса `Form<IOrder>` и представляет собой форму оформления заказа. Он отвечает за управление выбором способа оплаты, вводом адреса доставки и обработкой действий пользователя при оформлении заказа.

**Конструктор класса**

```typescript
constructor(container: HTMLFormElement, protected events: IEvents)
```

**Параметры:**
1. **`container: HTMLFormElement`** - корневой DOM-элемент формы заказа. Должен содержать:
   - Кнопки выбора способа оплаты с именами 'card' (онлайн) и 'cash' (оффлайн)
   - Поле ввода адреса с именем 'address'
   - Кнопку отправки формы (наследуется от `Form`)

2. **`events: IEvents`** (protected) - экземпляр системы событий, реализующий интерфейс `IEvents`. Используется для генерации событий при взаимодействии пользователя с формой.

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Form` с переданными контейнером и системой событий.
2. Инициализирует кнопки выбора способа оплаты:
   - Находит кнопку онлайн-оплаты по имени 'card'
   - Находит кнопку оффлайн-оплаты по имени 'cash'
   - Приводит типы к `HTMLButtonElement`
3. Настраивает обработчики кликов на кнопках оплаты, которые генерируют события:
   - `payment:change` с параметром `{payment: 'online'}` для онлайн-оплаты
   - `payment:change` с параметром `{payment: 'offline'}` для оффлайн-оплаты

**Свойства класса**

1. **`protected buttonOnlinePayment: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Ссылка на кнопку выбора онлайн-оплаты. Находится по имени 'card' среди элементов формы.

2. **`protected buttonOfflinePayment: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Ссылка на кнопку выбора оффлайн-оплаты. Находится по имени 'cash' среди элементов формы.

3. **`protected events: IEvents`**  
   - *Тип:* `IEvents`  
   - *Описание:* Экземпляр системы событий, унаследованный от параметра конструктора. Используется для генерации событий при взаимодействии с формой.

4. **`protected _submit: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Кнопка отправки формы, наследуемая от родительского класса `Form`.

**Сеттеры**

1. **`set address(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Устанавливает значение в поле ввода адреса доставки. Находит элемент по имени 'address' среди элементов формы, приводит тип к `HTMLInputElement` и устанавливает переданное значение.

2. **`set payment(value: PaymentType)`**  
   - *Тип параметра:* `PaymentType` (предположительно 'online' | 'offline')  
   - *Описание:* Управляет визуальным выделением выбранного способа оплаты:
     - Добавляет класс `button_alt-active` к кнопке онлайн-оплаты, если выбран 'online'
     - Добавляет класс `button_alt-active` к кнопке оффлайн-оплаты, если выбран 'offline'
     - Использует метод `toggleClass` для управления классами CSS

3. **`set enable(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Управляет состоянием кнопки отправки формы (`_submit`):
     - Если передано truthy-значение (непустая строка), кнопка становится активной
     - Если передано falsy-значение (пустая строка, undefined и т.д.), кнопка блокируется
     - Использует наследуемый метод `setDisabled`


### Класс `Contacts`

**Общая информация**
Класс `Contacts` наследуется от класса `Form<IOrder>` и представляет собой форму ввода контактных данных пользователя при оформлении заказа. Он отвечает за управление полями ввода email и телефона, а также за активацию/деактивацию кнопки отправки формы в зависимости от заполненности полей.

**Конструктор класса**

```typescript
constructor(container: HTMLFormElement, protected events: IEvents)
```

**Параметры:**
1. **`container: HTMLFormElement`** - корневой DOM-элемент формы контактов. Должен содержать:
   - Поле ввода email с именем 'email'
   - Поле ввода телефона с именем 'phone'
   - Кнопку отправки формы (наследуется от `Form`)

2. **`events: IEvents`** (protected) - экземпляр системы событий, реализующий интерфейс `IEvents`. Используется для обработки событий формы (наследуется от родительского класса `Form`).

**Описание работы конструктора:**
Вызывает конструктор родительского класса `Form` с переданными контейнером и системой событий.

**Свойства класса**

1. **`protected events: IEvents`**  
   - *Тип:* `IEvents`  
   - *Описание:* Экземпляр системы событий, унаследованный от параметра конструктора. Используется для обработки событий формы.

2. **`protected _submit: HTMLButtonElement`**  
   - *Тип:* `HTMLButtonElement`  
   - *Описание:* Кнопка отправки формы, наследуемая от родительского класса `Form`.

**Сеттеры**

1. **`set email(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Устанавливает значение в поле ввода email. Находит элемент по имени 'email' среди элементов формы, приводит тип к `HTMLInputElement` и устанавливает переданное значение.

2. **`set phone(value: string)`**  
   - *Тип параметра:* `string`  
   - *Описание:* Устанавливает значение в поле ввода телефона. Находит элемент по имени 'phone' среди элементов формы, приводит тип к `HTMLInputElement` и устанавливает переданное значение.

3. **`set enable(data: {email: string, phone: string})`**  
   - *Тип параметра:* `{email: string, phone: string}` - объект с текущими значениями полей email и телефона  
   - *Описание:* Управляет состоянием кнопки отправки формы (`_submit`):
     - Если оба поля (email и phone) содержат непустые строки, кнопка становится активной
     - Если хотя бы одно поле пустое, кнопка блокируется
     - Использует наследуемый метод `setDisabled` для изменения состояния кнопки

### Класс `Success`

**Общая информация**
Класс `Success` является наследником класса `Component` с типизацией `IOrder` и представляет собой компонент, отображающий успешное завершение заказа.

*Конструктор класса*

```typescript
constructor(container: HTMLFormElement, protected events: IEvents)
```

**Параметры:**
- `container: HTMLFormElement` - HTML-элемент формы, который является контейнером для компонента
- `events: IEvents` - объект для работы с событиями (Event Emitter)

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Component` с переданным контейнером
2. Инициализирует элемент `orderSuccessDescription`, находящийся внутри контейнера по селектору `.order-success__description`
3. Инициализирует кнопку `finishButton`, находящуюся внутри контейнера по селектору `.order-success__close` (с приведением типа к `HTMLButtonElement`)
4. Добавляет обработчик события `click` на кнопку `finishButton`, который инициирует событие `'success:close'` через объект `events`

**Свойства класса**

1. **`protected orderSuccessDescription: HTMLElement`**
- **Тип:** `HTMLElement`
- **Описание:** Элемент для отображения описания успешного завершения заказа. Находится в DOM по селектору `.order-success__description`.

2. **`protected finishButton: HTMLButtonElement`**
- **Тип:** `HTMLButtonElement`
- **Описание:** Кнопка закрытия/завершения, находящаяся в DOM по селектору `.order-success__close`. При нажатии инициирует событие закрытия успешного заказа.

3. **`protected events: IEvents`**
- **Тип:** `IEvents`
- **Описание:** Объект для работы с событиями (Event Emitter), переданный в конструктор. Используется для генерации события при нажатии на кнопку завершения.

**Сеттеры**

1. **`set total(value: number)`**
   - *Тип параметра:* `number` 
   - *Описание:* Устанавливает текст в элементе `orderSuccessDescription` с информацией о сумме списания. Формат текста: `"Списано {value} синапсов"`, где `{value}` заменяется на переданное числовое значение.


## Слой Модели данных

---

### Класс `AppState`

**Общая информация**
Класс `AppState` реализует интерфейс `IAppState` и представляет собой централизованное хранилище состояния приложения. Он отвечает за:
- Управление каталогом товаров
- Управление корзиной покупок
- Управление данными заказа
- Валидацию данных заказа
- Генерацию событий при изменении состояния

**Конструктор класса**

```typescript
constructor(protected events: EventEmitter)
```

**Параметры:**
1. **`events: EventEmitter`** (protected) - экземпляр системы событий для оповещения об изменениях состояния

**Описание работы конструктора:**
1. Инициализирует экземпляр `EventEmitter` для управления событиями
2. Инициализирует начальные состояния:
   - Пустой каталог товаров (`catalogList`)
   - Пустую корзину (`cartList`)
   - Пустой заказ с дефолтными значениями (`orderList`)
   - Пустой объект ошибок формы (`formErrors`)

**Свойства класса**

1. **`protected catalogList: IProduct[]`**  
   - *Тип:* Массив `IProduct`  
   - *Описание:* Хранит список товаров в каталоге. Инициализируется пустым массивом.

2. **`protected cartList: IProduct[]`**  
   - *Тип:* Массив `IProduct`  
   - *Описание:* Хранит список товаров в корзине. Инициализируется пустым массивом.

3. **`protected orderList: IOrder`**  
   - *Тип:* Объект `IOrder`  
   - *Начальные значения:*
     ```typescript
     {
       payment: 'online',
       email: '',
       phone: '',
       address: '',
       total: 0,
       items: []
     }
     ```
   - *Описание:* Хранит данные текущего заказа.

4. **`formErrors: FormErrors`**  
   - *Тип:* Объект `FormErrors` (предположительно `Record<string, string>`)  
   - *Описание:* Хранит ошибки валидации формы заказа. Инициализируется пустым объектом.

5. **`protected events: EventEmitter`**  
   - *Тип:* `EventEmitter`  
   - *Описание:* Система событий для оповещения об изменениях состояния.

**Методы класса**

1. **`getCartCount(): number`**  
   - *Возвращает:* `number` - количество товаров в корзине  
   - *Описание:* Возвращает текущее количество товаров в корзине (длину массива `cartList`).

2. **`getCartTotal(): number`**  
   - *Возвращает:* `number` - общую стоимость товаров в корзине  
   - *Описание:* Вычисляет сумму цен всех товаров в корзине и обновляет `orderList.total`.

3. **`addToCart(product: IProduct): void`**  
   - *Параметры:*
     - `product: IProduct` - добавляемый товар  
   - *Описание:*
     - Добавляет товар в корзину, если его еще нет
     - Обновляет общую сумму заказа
     - Генерирует событие `'cartCount:changed'`

4. **`removeFromCart({id}: Partial<IProduct>): void`**  
   - *Параметры:*
     - `id: string` (из деструктурированного объекта) - ID удаляемого товара  
   - *Описание:*
     - Удаляет товар из корзины по ID
     - Обновляет общую сумму заказа
     - Генерирует событие `'cartCount:changed'`

5. **`clearCart(): void`**  
   - *Описание:*
     - Очищает корзину
     - Сбрасывает общую сумму заказа
     - Генерирует событие `'cartCount:changed'`

6. **`setOrderField(field: keyof IOrderForm, value: string): void`**  
   - *Параметры:*
     - `field: keyof IOrderForm` - поле заказа для обновления
     - `value: string` - новое значение поля  
   - *Описание:*
     - Обновляет указанное поле в заказе
     - Вызывает валидацию заказа

7. **`validateOrder(): boolean`**  
   - *Возвращает:* `boolean` - результат валидации (true если ошибок нет)  
   - *Описание:*
     - Проверяет обязательные поля заказа (адрес, email, телефон)
     - Заполняет объект `formErrors` сообщениями об ошибках
     - Генерирует событие `'formErrors:change'` с текущими ошибками
     - Возвращает true если ошибок валидации нет

**Геттеры и сеттеры**

**Каталог товаров**
1. **`get catalog(): IProduct[]`**  
   - *Возвращает:* `IProduct[]` - текущий каталог товаров  
   - *Описание:* Возвращает массив товаров из `catalogList`

2. **`set catalog(catalog: IProduct[])`**  
   - *Параметры:* `catalog: IProduct[]` - новый каталог товаров  
   - *Описание:*
     - Обновляет каталог товаров
     - Генерирует событие `'catalog:changed'`

**Корзина покупок**
3. **`get cart(): IProduct[]`**  
   - *Возвращает:* `IProduct[]` - текущую корзину товаров  
   - *Описание:* Возвращает массив товаров из `cartList`

4. **`set cart(cart: IProduct[])`**  
   - *Параметры:* `cart: IProduct[]` - новая корзина товаров  
   - *Описание:* Обновляет корзину товаров (без генерации событий)

**Данные заказа**
5. **`get order(): IOrder`**  
   - *Возвращает:* `IOrder` - текущие данные заказа  
   - *Описание:* Возвращает объект заказа из `orderList`

6. **`set order(order: IOrder)`**  
   - *Параметры:* `order: IOrder` - новые данные заказа  
   - *Описание:* Полностью заменяет данные заказа (без генерации событий)

### Класс `Api`

**Общая информация**
Класс `Api` представляет собой обертку для работы с HTTP-запросами к серверу. Он предоставляет:
- Базовые методы для выполнения GET и POST запросов
- Унифицированную обработку ответов сервера
- Конфигурируемые параметры запросов
- Типизированные методы для работы с API

**Конструктор класса**

```typescript
constructor(baseUrl: string, options: RequestInit = {})
```

**Параметры:**
1. **`baseUrl: string`** (readonly) - базовый URL API, к которому будут добавляться endpoint'ы
2. **`options: RequestInit`** (необязательный) - объект с настройками HTTP-запросов:
   - По умолчанию: `{}`
   - Может содержать любые параметры из `RequestInit`

**Описание работы конструктора:**
1. Сохраняет переданный базовый URL в свойство `baseUrl`
2. Инициализирует стандартные настройки запросов:
   - Устанавливает заголовок `Content-Type: application/json`
   - Добавляет переданные в конструкторе заголовки (если есть)
   - Сохраняет все настройки в свойство `options`

**Свойства класса**

1. **`readonly baseUrl: string`**  
   - *Тип:* `string`  
   - *Описание:* Базовый URL API, который используется как основа для всех запросов. Не может быть изменен после создания экземпляра.

2. **`protected options: RequestInit`**  
   - *Тип:* `RequestInit` (стандартный тип из Fetch API)  
   - *Начальные значения:*
     ```typescript
     {
       headers: {
         'Content-Type': 'application/json',
         ...(переданные в конструкторе заголовки)
       }
     }
     ```
   - *Описание:* Хранит базовые настройки для всех HTTP-запросов. Защищенное свойство, доступное только внутри класса и его наследников.

**Методы класса**

1. **`protected handleResponse<T>(response: Response): Promise<T>`**  
   - *Параметры:*
     - `response: Response` - объект ответа от сервера
   - *Возвращает:* `Promise<T>` - промис с типизированными данными ответа или ошибкой
   - *Описание:*
     - Проверяет статус ответа (response.ok)
     - При успешном ответе преобразует ответ в JSON с указанным типом T
     - При ошибке пытается извлечь сообщение об ошибке из ответа или использует стандартный statusText
     - Возвращает отклоненный промис с ошибкой

2. **`get<T>(uri: string): Promise<T>`**  
   - *Параметры:*
     - `uri: string` - endpoint API (добавляется к baseUrl)
   - *Возвращает:* `Promise<T>` - промис с типизированными данными ответа
   - *Описание:*
     - Выполняет GET-запрос к указанному endpoint
     - Использует базовые настройки из this.options
     - Добавляет метод GET
     - Обрабатывает ответ через handleResponse<T>

3. **`post<T>(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<T>`**  
   - *Параметры:*
     - `uri: string` - endpoint API
     - `data: object` - данные для отправки на сервер
     - `method: ApiPostMethods` (необязательный) - HTTP-метод (по умолчанию 'POST')
   - *Возвращает:* `Promise<T>` - промис с типизированными данными ответа
   - *Описание:*
     - Выполняет POST-подобный запрос (POST/PUT/PATCH) к указанному endpoint
     - Преобразует данные в JSON-строку
     - Использует базовые настройки из this.options
     - Устанавливает переданный метод (по умолчанию POST)
     - Обрабатывает ответ через handleResponse<T>

### Класс `LarekAPI`

**Общая информация**
Класс `LarekAPI` наследуется от базового класса `Api` и предоставляет специализированные методы для работы с API интернет-магазина. Он добавляет:
- Поддержку CDN для изображений товаров
- Типизированные методы для работы с продуктами и заказами
- Автоматическую обработку URL изображений товаров

**Конструктор класса**

```typescript
constructor(cdn: string, baseUrl: string, options?: RequestInit)
```

**Параметры:**
1. **`cdn: string`** (readonly) - базовый URL CDN для изображений товаров
2. **`baseUrl: string`** - базовый URL API (передается в родительский класс)
3. **`options?: RequestInit`** (необязательный) - дополнительные настройки HTTP-запросов (передаются в родительский класс)

**Описание работы конструктора:**
1. Вызывает конструктор родительского класса `Api` с параметрами `baseUrl` и `options`
2. Инициализирует свойство `cdn` переданным значением

**Свойства класса**

1. **`readonly cdn: string`**  
   - *Тип:* `string`  
   - *Описание:* Базовый URL CDN сервера, используемый для формирования полных путей к изображениям товаров. Не может быть изменен после создания экземпляра.

2. **Унаследованные от `Api` свойства:**
   - `readonly baseUrl: string` - базовый URL API
   - `protected options: RequestInit` - настройки HTTP-запросов

**Методы класса**

1. **`getProducts(): Promise<IProductResponse>`**  
   - *Возвращает:* `Promise<IProductResponse>` - промис с ответом сервера, содержащим список товаров  
   - *Описание:*
     - Выполняет GET-запрос к endpoint `/product` через родительский метод `get`
     - Обрабатывает ответ, добавляя к URL каждого изображения товара базовый CDN-адрес
     - Возвращает модифицированный ответ с полными путями к изображениям
   - *Используемые типы:*
     - `IProductResponse` - тип ответа сервера с массивом товаров
     - `IProduct` - интерфейс описания товара

2. **`getProductById(id: string): Promise<IProduct>`**  
   - *Параметры:*
     - `id: string` - идентификатор запрашиваемого товара  
   - *Возвращает:* `Promise<IProduct>` - промис с данными о товаре  
   - *Описание:*
     - Выполняет GET-запрос к endpoint `/product/{id}` через родительский метод `get`
     - Возвращает данные о конкретном товаре без модификации URL изображения
     - (Примечание: при необходимости можно добавить обработку CDN аналогично `getProducts`)

3. **`setOrder(order: IOrder): Promise<IOrder>`**  
   - *Параметры:*
     - `order: IOrder` - данные заказа для отправки на сервер  
   - *Возвращает:* `Promise<IOrder>` - промис с ответом сервера о созданном заказе  
   - *Описание:*
     - Выполняет POST-запрос к endpoint `/order` через родительский метод `post`
     - Отправляет данные заказа в формате JSON
     - Возвращает ответ сервера без модификации
   - *Используемые типы:*
     - `IOrder` - интерфейс данных заказа

---

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
